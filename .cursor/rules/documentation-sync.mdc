---
description: Documentation sync rule - proactively assesses documentation impact BEFORE code changes, gives users control over scope, and maintains doc accuracy
alwaysApply: false
tags: [documentation, sync, updates, maintenance, proactive]
relatedDocs:
  - Documentation/0_INDEX.md
  - Documentation/2_Architecture/COMPONENT_MAP.md
version: 2.1
lastUpdated: 2025-10-30
---

# Documentation Sync Rule

**Purpose**: Ensure documentation stays in sync with code changes by **proactively assessing** documentation impact BEFORE making changes and giving users control over the update scope.

**Reference**: `Documentation/0_INDEX.md` for complete documentation structure

---

## üéØ Quick Decision Tree

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 USER REQUEST RECEIVED                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ
                   ‚ñº
          Is it a code change? ‚îÄ‚îÄ‚îÄ‚îÄNO‚îÄ‚îÄ‚îÄ‚Üí Proceed normally
                   ‚îÇ YES
                   ‚ñº
            üõë STOP HERE üõë
                   ‚îÇ
                   ‚ñº
       Will it affect documentation?
                   ‚îÇ
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ                   ‚îÇ
        YES                 NO
         ‚îÇ                   ‚îÇ
         ‚îÇ                   ‚îî‚îÄ‚îÄ‚Üí Proceed with code
         ‚îÇ                        (minor UI tweaks,
         ‚îÇ                         small bug fixes)
         ‚ñº
  üìã Use Assessment Template Below
         ‚îÇ
         ‚ñº
  Present: Code Plan + Doc Impact
         ‚îÇ
         ‚ñº
  ‚è∏Ô∏è  WAIT for User Decision
  (DO NOT MAKE ANY CODE CHANGES YET)
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ         ‚îÇ             ‚îÇ          ‚îÇ
Together  Separately     Skip      Cancel
    ‚îÇ         ‚îÇ             ‚îÇ          ‚îÇ
    ‚ñº         ‚ñº             ‚ñº          ‚ñº
 Code +    Code only,   Code only,  Don't
  Docs     user does    no docs    proceed
           docs later
```

---

## ‚ö° Proactive Workflow (CRITICAL)

### Assess Documentation Impact BEFORE Code Changes

**When user requests a change:**

1. **Analyze impact** - Will this change affect any documentation?
2. **Inform user upfront** - Tell them which docs will need updates
3. **Offer choice** - Let them decide scope: Together / Separately / Skip
4. **Execute accordingly** - Respect their decision

---

## üìã REQUIRED RESPONSE TEMPLATE

**USE THIS EXACT FORMAT when documentation is affected:**

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üîÑ CODE + DOCUMENTATION IMPACT ASSESSMENT                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

```markdown
I'll [describe code changes]:
- [Change 1]
- [Change 2]
- [Change 3]

üìù Documentation impact:
‚îú‚îÄ [Doc file path] (line X)
‚îÇ  [What needs updating and why]
‚îî‚îÄ [Doc file path] (lines X-Y)
   [What needs updating and why]

Should I update documentation as part of this task?
- **Together**: I'll update docs with code changes now
- **Separately**: I'll make code changes, you handle docs later
- **Skip**: Make code changes only, no doc updates

‚è∏Ô∏è  WAITING FOR YOUR DECISION - No code changes will be made until you respond.
```

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚ö†Ô∏è  CRITICAL: DO NOT proceed with code changes until user   ‚îÇ
‚îÇ    responds with their choice (Together/Separately/Skip)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

---

### Key Principles

‚úÖ **DO**: Assess docs BEFORE making code changes (like TODOs - plan upfront)
‚úÖ **DO**: Include doc assessment in initial response to user
‚úÖ **DO**: Give user explicit choice about scope
‚úÖ **DO**: Default to including docs unless user defers

‚ùå **DON'T**: Make code changes then ask about docs (too late)
‚ùå **DON'T**: Assume user wants docs updated (ask first)
‚ùå **DON'T**: Skip assessment because "it might not need docs"

### Real Example: Proactive Assessment

**User Request**: "Remove the animation on the Welcome screen"

**‚ùå BAD (Reactive - Old Approach)**:
```
[AI makes code changes immediately]
[AI completes all code changes]
[AI then asks]: "Should we update the documentation?"
‚Üí User has to make decision after work is done
‚Üí Inefficient, documentation feels like afterthought
```

**‚úÖ GOOD (Proactive - New Approach)**:
```
I'll remove all animations from LandingPageView.swift:
- Scrolling image rows animation
- Sequential text/icon fade-ins
- Button pulsing animation
- Transition fade effects

üìù Documentation impact:
‚îú‚îÄ Documentation/1_Product/FEATURE_CATALOG.md (line 11)
‚îÇ  "Animated Landing Page" ‚Üí "Static Landing Page"
‚îî‚îÄ Documentation/1_Product/PRODUCT_OVERVIEW.md (lines 45, 155-156)
   References to "Onboarding Animation" ‚Üí "Landing Page"

Should I update documentation as part of this task? [Together/Separately/Skip]
‚Üí User makes informed decision upfront
‚Üí Efficient, documentation is part of the plan
```

---

## üéØ When to Trigger Documentation Assessment

### Trigger on Significant Changes

**Always Prompt** when:
- ‚úÖ Performance optimization (>20% improvement)
- ‚úÖ Architecture pattern changes
- ‚úÖ New feature implementation
- ‚úÖ Manager/Service file modifications (>50 lines)
- ‚úÖ Protocol changes or additions
- ‚úÖ Breaking changes to public APIs

**Don't Prompt** when:
- ‚ùå Minor UI tweaks (<30 lines)
- ‚ùå Small bug fixes
- ‚ùå Comment-only changes
- ‚ùå Test file updates
- ‚ùå Documentation-only changes

---

## üìä Core File ‚Üí Documentation Mapping

### Camera System

**File**: `Klick/Camera/Views/CameraView.swift`

**Primary Documentation**:
- `Documentation/5_Features/CAMERA_SYSTEM.md` - Camera implementation
- `Documentation/2_Architecture/COMPONENT_MAP.md` - CameraView section (lines 138-195)

**Update When**:
- Frame processing logic changes
- Threading model modifications
- AVFoundation setup changes
- Vision framework integration updates

**Example**:
```swift
// BEFORE: Processing every frame
func captureOutput(_ output: AVCaptureOutput, ...) {
    processFrame(pixelBuffer)
}

// AFTER: Frame throttling added
func captureOutput(_ output: AVCaptureOutput, ...) {
    guard frameCount % 3 == 0 else { return }  // ‚Üê New optimization
    processFrame(pixelBuffer)
}

‚Üí UPDATE: Documentation/6_Performance/IMAGE_PROCESSING.md
  Reason: New frame throttling strategy
  Section: "Frame Processing Pipeline"
```

---

### Composition System

**File**: `Klick/CompositionService.swift`

**Primary Documentation**:
- `Documentation/5_Features/COMPOSITION_ANALYSIS.md` - Service architecture
- `Documentation/2_Architecture/COMPONENT_MAP.md` - CompositionService section (lines 250-300)

**Update When**:
- New composition service added
- Protocol definition changes
- Evaluation algorithm improvements
- Scoring methodology updates

**Example**:
```swift
// NEW SERVICE ADDED
class GoldenRatioService: CompositionService {
    let name = "Golden Ratio"
    
    func evaluate(...) -> CompositionResult {
        // Golden ratio implementation
    }
}

‚Üí UPDATE: Documentation/5_Features/COMPOSITION_ANALYSIS.md
  Add: GoldenRatioService section
  Update: Available services list
  Add: Usage example and scoring method

‚Üí UPDATE: Documentation/2_Architecture/COMPONENT_MAP.md
  Add: GoldenRatioService to service list
  Update: CompositionType enum

‚Üí UPDATE: .cursor/rules/architecture.mdc
  Add: GoldenRatioService as example
```

---

### Performance Optimizations

**File**: `Klick/BackgroundBlurManager.swift`

**Primary Documentation**:
- `Documentation/6_Performance/BLUR_OPTIMIZATION.md` - Blur performance
- `Documentation/5_Features/BLUR_EFFECTS.md` - Blur implementation

**Secondary Documentation**:
- `Documentation/6_Performance/IMAGE_PROCESSING.md` - Processing pipeline
- `Documentation/2_Architecture/COMPONENT_MAP.md` - BlurManager section

**Update When**:
- Processing speed improvements
- Memory usage reductions
- Caching strategy changes
- Algorithm modifications

**Example**:
```swift
// OPTIMIZATION: GPU acceleration added
private let context: CIContext = {
    if let metalDevice = MTLCreateSystemDefaultDevice() {
        return CIContext(mtlDevice: metalDevice, options: [
            .cacheIntermediates: true,  // ‚Üê New optimization
            .useSoftwareRenderer: false  // ‚Üê GPU acceleration
        ])
    }
    return CIContext()
}()

‚Üí UPDATE: Documentation/6_Performance/BLUR_OPTIMIZATION.md
  Update: Metal-accelerated context section
  Add: New performance benchmarks (before/after)
  Update: Memory usage metrics
  
‚Üí UPDATE: .cursor/rules/performance.mdc
  Add: Metal optimization as best practice
  Update: GPU acceleration guidelines
```

---

### Photo Management

**File**: `Klick/PhotoManager.swift`

**Primary Documentation**:
- `Documentation/5_Features/PHOTO_MANAGEMENT.md` - Photo system
- `Documentation/2_Architecture/COMPONENT_MAP.md` - PhotoManager section (lines 328-368)

**Update When**:
- Storage strategy changes
- New photo operations added
- File format changes
- Photo library integration updates

**Example**:
```swift
// NEW FEATURE: Batch delete
func deletePhotos(_ photoItems: [PhotoItem]) {
    for item in photoItems {
        try? FileManager.default.removeItem(at: item.url)
    }
    photos.removeAll { photoItems.contains($0) }
}

‚Üí UPDATE: Documentation/5_Features/PHOTO_MANAGEMENT.md
  Add: Batch operations section
  Update: PhotoManager API reference
  Add: Usage examples

‚Üí UPDATE: Documentation/3_Application_Flows/FLOW_PHOTO_MANAGEMENT.md
  Add: Batch delete flow diagram
  Update: User interaction patterns
```

---

### Filter System

**File**: `Klick/Services/FilterManager.swift`

**Primary Documentation**:
- `Documentation/5_Features/FILTER_SYSTEM.md` - Filter implementation

**Update When**:
- New LUT filter added
- Filter categories changed
- Performance improvements
- Caching strategy updates

**Example**:
```swift
// NEW FILTER CATEGORY
enum FilterCategory {
    case glow
    case cine
    case aesthetic
    case vintage  // ‚Üê New category added
}

‚Üí UPDATE: Documentation/5_Features/FILTER_SYSTEM.md
  Add: Vintage filter category section
  Update: Filter catalog
  Add: Example filters in category
```

---

## üìã Documentation Update Prompt Template

### Standard Prompt Format

```markdown
üìù Documentation Update Recommended

File Changed: [File path]
Change Type: [Performance/Architecture/Feature/Bug Fix]
Lines Changed: [Number]
Significance: [High/Medium/Low]

Detected Keywords: [optimization, new feature, refactor, etc.]

Primary Documentation Affected:
‚îú‚îÄ [Doc file path]
‚îÇ  Reason: [Why this doc needs update]
‚îÇ  Suggested sections: [Specific sections]
‚îÇ  Lines to review: [Line numbers if known]

Secondary Documentation Affected:
‚îú‚îÄ [Doc file path]
‚îÇ  Reason: [Cross-reference or related content]
‚îÇ  Suggested sections: [Specific sections]

Recommended Actions:
1. [Specific action]
2. [Specific action]
3. [Specific action]

Update documentation now? [Y/n]
Defer until later? [y/N]
Skip this time? [y/N]
```

---

## üéØ Real Examples from Klick

### Example 1: Performance Optimization

**Scenario**: Blur processing optimized from 300ms ‚Üí 30ms

**File Changed**: `Klick/BackgroundBlurManager.swift` (85 lines)

**Prompt**:
```markdown
üìù Documentation Update Recommended

File Changed: Klick/BackgroundBlurManager.swift
Change Type: Performance Optimization
Lines Changed: 85
Significance: High

Detected Keywords: "10x faster", "preview resolution", "caching"

Primary Documentation Affected:
‚îú‚îÄ Documentation/6_Performance/BLUR_OPTIMIZATION.md
‚îÇ  Reason: Performance metrics outdated
‚îÇ  Suggested sections: 
‚îÇ    - Benchmark Results (lines 45-78)
‚îÇ    - Optimization Strategies (lines 120-145)
‚îÇ    - Memory Usage (lines 180-200)
‚îÇ  Update with: New timings (300ms ‚Üí 30ms)

‚îú‚îÄ Documentation/5_Features/BLUR_EFFECTS.md
‚îÇ  Reason: Processing approach changed
‚îÇ  Suggested sections:
‚îÇ    - Preview Processing (lines 89-102)
‚îÇ    - Resolution Strategy (lines 150-165)

Secondary Documentation Affected:
‚îú‚îÄ Documentation/6_Performance/IMAGE_PROCESSING.md
‚îÇ  Reason: References blur in concurrent processing
‚îÇ  Suggested sections: Concurrent Processing (lines 78-95)

‚îú‚îÄ .cursor/rules/performance.mdc
‚îÇ  Reason: New best practices emerged
‚îÇ  Suggested sections: Resolution Optimization (lines 150-180)

Recommended Actions:
1. Update BLUR_OPTIMIZATION.md with new benchmarks
2. Document preview resolution strategy (400√ó600)
3. Add session-based caching explanation
4. Update memory footprint metrics (60% reduction)
5. Add lessons learned section

Update documentation now? [Y/n]
```

---

### Example 2: New Feature Addition

**Scenario**: Golden Ratio composition service added

**File Changed**: `Klick/CompositionService.swift` (120 lines added)

**Prompt**:
```markdown
üìù Documentation Update Recommended

File Changed: Klick/CompositionService.swift
Change Type: New Feature
Lines Changed: 120 (added)
Significance: High

Detected Keywords: "GoldenRatioService", "new composition", "fibonacci"

Primary Documentation Affected:
‚îú‚îÄ Documentation/5_Features/COMPOSITION_ANALYSIS.md
‚îÇ  Reason: New service implementation
‚îÇ  Suggested sections:
‚îÇ    - Available Services (add GoldenRatioService)
‚îÇ    - Service Implementations (add new section)
‚îÇ    - Usage Examples (add Golden Ratio example)

‚îú‚îÄ Documentation/2_Architecture/COMPONENT_MAP.md
‚îÇ  Reason: Component relationships changed
‚îÇ  Suggested sections:
‚îÇ    - CompositionService Protocol (lines 250-300)
‚îÇ    - Service Implementations (update list)

Secondary Documentation Affected:
‚îú‚îÄ Documentation/1_Product/FEATURE_CATALOG.md
‚îÇ  Reason: Roadmap feature completed
‚îÇ  Suggested sections: 
‚îÇ    - Implemented Features (move from roadmap)
‚îÇ    - Composition Techniques (add Golden Ratio)

‚îú‚îÄ .cursor/rules/architecture.mdc
‚îÇ  Reason: New service example
‚îÇ  Suggested sections: Protocol-Oriented Design examples

Recommended Actions:
1. Add GoldenRatioService documentation section
2. Document Fibonacci spiral calculation
3. Add usage example with code
4. Update CompositionType enum documentation
5. Update feature catalog (roadmap ‚Üí implemented)
6. Add educational content about Golden Ratio

Update documentation now? [Y/n]
```

---

### Example 3: Architecture Refactor

**Scenario**: Camera threading model improved

**File Changed**: `Klick/Camera/Views/CameraView.swift` (65 lines)

**Prompt**:
```markdown
üìù Documentation Update Recommended

File Changed: Klick/Camera/Views/CameraView.swift
Change Type: Architecture Change
Lines Changed: 65
Significance: High

Detected Keywords: "threading", "DispatchQueue", "async", "background"

Primary Documentation Affected:
‚îú‚îÄ Documentation/5_Features/CAMERA_SYSTEM.md
‚îÇ  Reason: Threading model changed
‚îÇ  Suggested sections:
‚îÇ    - Threading Architecture (major update)
‚îÇ    - Frame Processing Pipeline
‚îÇ    - Performance Characteristics

‚îú‚îÄ Documentation/2_Architecture/ARCHITECTURE_OVERVIEW.md
‚îÇ  Reason: Threading model is architectural pattern
‚îÇ  Suggested sections:
‚îÇ    - Threading Model (lines 525-575)
‚îÇ    - Performance Architecture

Secondary Documentation Affected:
‚îú‚îÄ Documentation/6_Performance/IMAGE_PROCESSING.md
‚îÇ  Reason: Processing pipeline affected
‚îÇ  Suggested sections: Concurrent Processing Strategy

‚îú‚îÄ .cursor/rules/performance.mdc
‚îÇ  Reason: New threading best practices
‚îÇ  Suggested sections: Threading Guidelines

Recommended Actions:
1. Update threading model documentation
2. Add new thread hierarchy diagram
3. Document queue priority changes
4. Update performance characteristics
5. Add code examples for new pattern

Update documentation now? [Y/n]
```

---

## üîç Change Detection Criteria

### High Priority (Always Prompt)

**Performance Claims**:
- Keywords: "faster", "optimization", "performance", "memory", "cache"
- Benchmark numbers in code/comments
- Algorithm changes in core processing

**Architecture Changes**:
- Protocol modifications
- New patterns introduced
- Threading model changes
- State management updates

**New Features**:
- New services/managers
- New composition rules
- New UI components
- New capabilities

### Medium Priority (Prompt if Doc Mentioned)

**Bug Fixes**:
- If existing documentation affected
- If behavior changed significantly
- If public API modified

**Refactoring**:
- If architectural pattern changed
- If component relationships modified
- If performance characteristics affected

### Low Priority (No Prompt)

**Minor Changes**:
- UI polish (<30 lines)
- Comment updates
- Code formatting
- Variable renaming (internal)

---

## ‚úÖ Documentation Update Checklist

### When Updating Documentation

**For Performance Changes**:
- [ ] Update benchmark numbers (before/after)
- [ ] Document optimization approach
- [ ] Update memory usage metrics
- [ ] Add lessons learned
- [ ] Update performance rule if applicable

**For Architecture Changes**:
- [ ] Update architecture diagrams
- [ ] Document new patterns
- [ ] Update component map
- [ ] Update related flows
- [ ] Update architecture rule examples

**For New Features**:
- [ ] Add feature documentation section
- [ ] Update feature catalog
- [ ] Add usage examples
- [ ] Update component map
- [ ] Update application flows
- [ ] Move from roadmap to implemented

**For All Changes**:
- [ ] Check cross-references
- [ ] Update line number references
- [ ] Verify code examples still accurate
- [ ] Update "Last Updated" dates
- [ ] Check for broken links

---

## üìä Core File Mapping Reference

### Quick Lookup Table

| File | Primary Docs | Update Trigger |
|------|-------------|----------------|
| `CameraView.swift` | CAMERA_SYSTEM.md, COMPONENT_MAP.md | Frame processing, threading |
| `CompositionService.swift` | COMPOSITION_ANALYSIS.md | New services, protocol changes |
| `CompositionManager.swift` | COMPOSITION_ANALYSIS.md, COMPONENT_MAP.md | Service management changes |
| `BackgroundBlurManager.swift` | BLUR_OPTIMIZATION.md, BLUR_EFFECTS.md | Performance, algorithm changes |
| `PhotoManager.swift` | PHOTO_MANAGEMENT.md | Storage, new operations |
| `FilterManager.swift` | FILTER_SYSTEM.md | New filters, categories |
| `ContentView.swift` | ARCHITECTURE_OVERVIEW.md, STATE_MANAGEMENT.md | State management changes |

---

## üéì Best Practices

### Do's

‚úÖ **Update immediately** after significant changes  
‚úÖ **Document reasoning** behind optimization decisions  
‚úÖ **Include benchmarks** for performance claims  
‚úÖ **Update cross-references** when component relationships change  
‚úÖ **Preserve context** by documenting "why" not just "what"  
‚úÖ **Use specific line numbers** when referencing code  

### Don'ts

‚ùå **Don't defer** documentation for "later"  
‚ùå **Don't skip** cross-reference updates  
‚ùå **Don't copy-paste** outdated examples  
‚ùå **Don't forget** to update "Last Updated" dates  
‚ùå **Don't assume** documentation is self-evident  
‚ùå **Don't leave** broken references or links  

---

## üîÑ Proactive Update Workflow

### Step 1: Analyze User Request (BEFORE Code Changes)
- User requests a change
- Identify which files will be modified
- Assess if change meets documentation trigger criteria

### Step 2: Map Documentation Impact
- Look up affected files in mapping table
- Identify primary and secondary docs
- Determine specific sections that need updates
- Assess significance (High/Medium/Low)

### Step 3: Inform User & Get Decision
- Present code changes plan
- Show documentation impact clearly
- Offer choices: Together / Separately / Skip
- Wait for user decision
- **DO NOT proceed to code changes until user decides**

### Step 4: Execute Based on Decision

**If "Together":**
- Make code changes
- Update documentation in same batch
- Verify cross-references
- Update timestamps

**If "Separately":**
- Make code changes only
- Note documentation needs updating
- User will handle docs separately

**If "Skip":**
- Make code changes only
- No documentation updates

### Step 5: Validate (If Docs Updated)
- Check for broken references
- Verify consistency across docs
- Ensure examples still accurate
- Confirm timestamps updated

---

## üìö Related Documentation

### Core Documentation Structure
- **Index**: `Documentation/0_INDEX.md` - Master navigation
- **Tech Stack**: `Documentation/TECH_STACK.md` - All frameworks
- **Architecture**: `Documentation/2_Architecture/` - System design
- **Features**: `Documentation/5_Features/` - Feature-specific docs
- **Performance**: `Documentation/6_Performance/` - Optimization guides

### Documentation Rules
- **This Rule**: `.cursor/rules/documentation-sync.mdc`
- **Architecture**: `.cursor/rules/architecture.mdc`
- **Performance**: `.cursor/rules/performance.mdc`
- **Main Index**: `.cursor/rules/oIndex.mdc`

---

## üéØ Key Principles

> "Documentation that's out of sync is worse than no documentation. It misleads and creates technical debt."

> "Proactive assessment beats reactive updates. Plan documentation with code, not after code."

**Goals**: 
1. Keep documentation as a trusted source of truth
2. Give users control over documentation scope
3. Make documentation planning part of the initial task assessment
4. Treat documentation like TODOs: plan upfront, not retroactively

---

**Remember**: 
- ‚úÖ Assess documentation impact BEFORE making code changes
- ‚úÖ Give users explicit choice about scope (Together/Separately/Skip)
- ‚úÖ Documentation planning is part of good task planning
- ‚ùå Don't make code changes then ask about docs as an afterthought
